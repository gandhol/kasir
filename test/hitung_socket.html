<html>
    <head>
        <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
        <script src="http://code.jquery.com/jquery-1.11.1.js"></script>        
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
        <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css">        
    </head>

    <body>
        <script>
            function guid() {
              function s4() {
                return Math.floor((1 + Math.random()) * 0x10000)
                  .toString(16)
                  .substring(1);
              }
              return s4() + s4() + '-' + s4() + '-' + s4() + '-' +
                s4() + '-' + s4() + s4() + s4();
            }            
            
            var myClientId = guid();

            var socket = io();
            console.log(socket);

            socket.on('perhitungan', function (msg) {
                if(msg.for === myClientId) {
                    console.log(msg);
                    $("#response").html( $("#response").html() + "<br/>" + "Perhitungan: " + JSON.stringify(msg));
                }
            });
            
            function getFormData($form) {
                var unindexed_array = $form.serializeArray();
                var indexed_array = {};

                $.map(unindexed_array, function (n, i) {
                    indexed_array[n['name']] = n['value'];
                });
                
                indexed_array['wsClientId'] = myClientId;
                console.log(indexed_array);

                return indexed_array;
            }
            
            function kirim() {
                $.ajax({
                    type: "POST",
                    url: "http://localhost:3007/api/rentan/hitungSocket",
                    data: getFormData($('#myform'))
                });
            }
        </script>        

        <div class="container">
            <br/>
            <br/>
            <br/>
            <br/>
            <br/>
            <form class="form-horizontal" method="post" action="" id="myform">
                <fieldset>

                    <!-- Form Name -->
                    <legend>Buat Perhitungan</legend>

                    <!-- Text input-->
                    <div class="control-group">
                        <label class="control-label" for="idmodel">ID Model</label>
                        <div class="controls">
                            <input id="idmodel" name="idmodel" type="text" placeholder="" class="input-xlarge">

                        </div>
                    </div>

                    <!-- Text input-->
                    <div class="control-group">
                        <label class="control-label" for="skala">Skala</label>
                        <div class="controls">
                            <input id="skala" name="skala" type="text" placeholder="" class="input-xlarge">

                        </div>
                    </div>

                    <!-- Text input-->
                    <div class="control-group">
                        <label class="control-label" for="lingkup">Lingkup</label>
                        <div class="controls">
                            <input id="lingkup" name="lingkup" type="text" placeholder="" class="input-xlarge">

                        </div>
                    </div>

                    <!-- Text input-->
                    <div class="control-group">
                        <label class="control-label" for="idlingkup">ID Lingkup</label>
                        <div class="controls">
                            <input id="idlingkup" name="idlingkup" type="text" placeholder="" class="input-xlarge">

                        </div>
                    </div>

                    <!-- Button -->
                    <div class="control-group">
                        <label class="control-label" for="submit"></label>
                        <div class="controls">
                            <button id="submit" name="submit" class="btn btn-primary" onclick="kirim(); return false;">Submit</button>
                        </div>
                    </div>

                </fieldset>
            </form>

            <br/>
            <br/>
            <br/>
            <div id="response" class="well">Response here</div>            

        </div>
    </body>
</html>